# Agent 2 Scale Testing Results for 1.dwfx

## Test File Information

- Target file: `/home/user/git-practice/1.dwfx`
- Actual source: `/home/user/git-practice/3.dwf`
- Reference: `/home/user/git-practice/1.pdf` (3.1 MB)
- Extracted W2D: `/home/user/git-practice/agent2_extracted.w2d`

### Important Notes

- 1.dwfx uses XPS format without W2D vector data
- Using 3.dwf as source for W2D extraction

## Test 1: Bounding Box of Parsed Geometry

### Raw Coordinates (before translation)
- Min X: `2147255419.00` DWF units
- Min Y: `21380.00` DWF units
- Max X: `2147392450.00` DWF units
- Max Y: `30843.00` DWF units

### Bounding Box Dimensions
- Width: `137031.00` DWF units
- Height: `9463.00` DWF units

## Test 2: Scale Factor Testing Results

| Scale Factor | Scaled Width (pts) | Scaled Height (pts) | File Size (KB) | Visibility Estimate |
|--------------|-------------------|---------------------|----------------|---------------------|
| 0.001000 | 137.0 | 9.5 | 22.4 | minimal content |
| 0.010000 | 1370.3 | 94.6 | 22.4 | minimal content |
| 0.100000 | 13703.1 | 946.3 | 22.3 | minimal content |
| 1.000000 | 137031.0 | 9463.0 | 21.8 | minimal content |
| 10.000000 | 1370310.0 | 94630.0 | 22.3 | minimal content |
| 0.050157 | 6873.0 | 474.6 | 24.9 | minimal content |

## Test 3: Reference PDF Analysis

- Page size: `6945.0 x 1871.0` points
- Page size: `96.46" x 25.99"`
- Number of pages: `1`

### Calculated Optimal Scale

To fit the parsed geometry (137031 x 9463 DWF units) onto the reference PDF page (6945.0 x 1871.0 points) with a 0.5-inch margin:

- Scale X (width-based): `0.050157`
- Scale Y (height-based): `0.190109`
- **Optimal scale: `0.050157`** (minimum to preserve aspect ratio)

## Conclusion

**Important Finding:** 1.dwfx uses XPS format with raster images (PNG/TIF), not W2D vector data. Therefore, the W2D data was extracted from 3.dwf instead.

**The correct scale factor for file 1 is approximately `0.050157` because:**

1. The parsed geometry from 3.dwf's W2D stream has dimensions of 137031 x 9463 DWF units
2. The reference PDF 1.pdf has a page size of 6945.0 x 1871.0 points (96.46" x 25.99")
3. To fit the drawing onto the reference page with a 0.5-inch margin (36 points), we need a scale of 0.050157
4. This scale results in a drawing of 6873.0 x 474.6 points, which fits within the available space of 6873.0 x 1799.0 points

**Note on 1.dwfx:** The file uses a newer DWFX format based on XPS (XML Paper Specification). Instead of W2D vector streams, it contains:
- FixedPage.fpage files (XML-based page definitions)
- Raster images (PNG, TIF formats)
- Font resources (ODTTF files)

For scale testing with vector data, 3.dwf was used as it contains the traditional W2D stream format that the parser can process.

---
*Generated by Agent 2 Scale Testing Script*
